---
layout: post
comments: true
excerpt_separator: "<!--more-->"
published: true
title: Формули для Airtable
categories: airtable, saas
---

Airtable протягом років залишається для мене найзручнішим рішенням для сортування та обробки табличних даних. Швидко згрупувати інформацію за певним критерієм і паралельно відсортувати за кількома параметрами, налаштувати вьюшкти з лімітованою кількістю інформації, засетапити лукапи і зробити порівняння чи підтягування інформації з іншої таблиці... Це лише базові речі, які дозволяє робити цей сервіс. (Не кажучи вже про усілякі екстенши і більш просунуті можливості сервісу - про них можна говорити днями).

Тож, зрозуміло, що у моєму випадку ексель і гугл таблиці у більшості випадків програють Airtable вчисту. Хоча і тут без формул, буває, не обійтись. Тож роблю для себе нотатку з рішеннями для найбільш частих сценаріїв.

**Об'єднання даних декількох полів**

Робиться за допомогою символа "&".

    {Field 1} & {Field 2}

Вкупі з перевіркою на наявність інформації і додатковими коментарями може виглядати ось так:

    IF({Field1}, {Field1}&"<br/>") & IF({Field2}, {Field2})

Можна також перевіряти на значення поля, а також прописувати дію для негативного сценарію:

    IF(Thermometer = "yes", "Thermometer ") &
    
    IF(Thermometer_Cover = "yes", "Thermometer Cover", "There is no cover") 

**Розділення полів**

Зворотній сценарій - коли потрібно розділити вміст комірки на окремі поля. Для цього існує декілька функцій, мене найбільш виручає розділення за входженням (в даному випадку - по символу пробілу):

    LEFT(FieldName, SEARCH(" ", FieldName)-1)

**Очистка вмісту полів з перезаписуваннями даних**

Часто потрібно призвести вміст комірок до "спільного знаменника". Наприклад, у нас є поле, кожна комірка якого може містити багато емейл-адрес. Але біда! Недбалі колеги записували ці дані хто як: хтось розділяв за допомогою пробілу, хтось полюбляє коми, дехто віддає перевагу перенесенню на новий рядок, а комусь сподобалась крапка з комою чи взагалі комбінація усіх цих способів у неймовірних варіаціях. А ми б хотіли б усе стандартизувати у розділити усі емейл-адреси саме через пробіл. Без проблем:

    IF(FIND(Emails, "; ") > 0, SUBSTITUTE(Emails, "; ", " "),
    
      IF(FIND(Emails, ", ") > 0, SUBSTITUTE(Emails, ", ", " "),
    
         IF(FIND(Emails, "\n") > 0, SUBSTITUTE(Emails, "\n",  " "),
    
           SUBSTITUTE(Emails, ". ", " ")
    
       )
    
      )
    
    )